# GraphPrinter

![Plugin](https://user-images.githubusercontent.com/51815450/170719311-8dd70514-ef6b-4649-82bd-6be9232ae16e.PNG)

<!--ts-->
   * [概要](#概要)
      * [エディタ上での状態](#エディタ上での状態)
      * [出力された画像](#出力された画像)
      * [ノードの復元](#ノードの復元)
   * [動作環境](#動作環境)
   * [インストール](#インストール)
   * [使い方](#使い方)
   * [オプション](#オプション)
   * [ライセンス](#ライセンス)
   * [作者](#作者)
   * [履歴](#履歴)
<!--te-->

## 概要

このプラグインはUnreal Engineのグラフエディタ(BlueprintやMaterialなど...)を画像ファイルに出力、またはクリップボードにコピーするショートカットキーを追加します。
また、下の画像の様にグラフエディタで表示していない部分も含めて画像ファイルに出力できます。
さらに出力した画像ファイルからノードを復元することもできます。  

#### エディタ上での状態  
![BeforeExport](https://user-images.githubusercontent.com/51815450/170719166-b02a5526-d052-404c-bb13-d888ad7c080f.PNG)

#### 出力された画像  
![BP_Sky_Sphere-RefreshMaterial](https://user-images.githubusercontent.com/51815450/170719253-f5365b35-e86c-4b1a-ac0a-7b3f425c050f.png)

#### ノードの復元  
![Restore](https://user-images.githubusercontent.com/51815450/170719064-ed8ef47a-85c5-47b0-b243-951fe4e3e212.gif)

## 動作環境

対象バージョン : UE4.21 ～ 5.0  
対象プラットフォーム : Windows, Mac, Linux 

## インストール

プロジェクトのPluginsフォルダに[Plugins/GraphPrinter](https://github.com/Naotsun19B/GraphPrinter)フォルダを入れてください。  
または、[マーケットプレイス](https://www.unrealengine.com/marketplace/en/product/graph-printer)からインストールしてください。  
プラグインのインストール後に機能が使用できない場合は、プラグインが有効化されていない可能性がありますので、編集 > プラグイン からプラグインの有効のチェックが入っているかをご確認ください。  

## 使い方

追加される機能と対応するデフォルトのショートカットキーは以下の通りです。

| **ショートカットキー**　 | 　**機能**                                                              |
|:--------------:|----------------------------------------------------------------------|
|   Ctrl + F7    | 現在開いているグラフエディタのすべてのノードをクリップボードにコピーする。(**Windows限定 / ノード情報の埋め込みは不可**) |
|   Ctrl + F8    | 現在開いているグラフエディタの選択中のノードをクリップボードにコピーする。(**Windows限定 / ノード情報の埋め込みは不可**) |
|   Ctrl + F9    | 現在開いているグラフエディタのすべてのノードを含む画像を出力します。                                   |
|   Ctrl + F10   | 現在開いているグラフエディタの選択中のノードを含む画像を出力します。                                   |
|   Ctrl + F11   | 現在開いているグラフエディタに選択したpngファイルに含まれるノードを復元します。                            |
|   Ctrl + F12   | エディタの環境設定で設定されている出力先のディレクトリを開きます。                                    |

また、ショートカットキーはエディタの環境設定のキーボードショートカットから変更できます。

![KeyboardShortcuts](https://user-images.githubusercontent.com/51815450/170719363-f04a65c2-d08d-4cef-bc92-80d6703d450b.PNG)

## オプション

![EditorPreferences](https://user-images.githubusercontent.com/51815450/170719402-052f2f9e-91f3-41ab-9868-5e03bdfc4b31.PNG)

エディタの環境設定から設定できる項目は以下の通りです。

| **セクション**      　　      | **項目**                             | **説明**                                                                                                  |
|------------------------|------------------------------------|---------------------------------------------------------------------------------------------------------|
| Widget Printer         | Is Include Node Info in Image File | 出力する画像ファイルにノードの情報を埋め込み、画像ファイルからノードを復元する機能をオンにします。　                                                      |
|                        | Format                             | 出力する画像の形式を設定します。対応している画像フォーマットは*png*、*jpeg*、*bmp*、*exr*です。                                              |
|                        | Compression Quality                | 出力する画像の圧縮率を設定します。                                                                                       |
|                        | Filtering Mode                     | 出力する際に使用するテクスチャのフィルタリングモードを設定します。                                                                       |
|                        | Use Gamma                          | 出力する画像にガンマ値を反映するかを設定します。*false*の場合、出力された画像がエディタで見るよりも暗くなる場合があります。                                       |
|                        | Max Image Size                     | 出力画像の最大サイズを設定します。 このサイズを超えると出力できません。                                                                    |
|                        | Rendering Scale                    | グラフを描画するための縮尺が0.5の場合、半分の解像度で描画されます。Max Image Sizeよりも大きいグラフを描画する場合は値を小さくします。値を小さくすると描画結果に欠陥が生じる可能性があります。 |
|                        | Can Overwrite File when Export     | 画像を出力する際に同名のファイルを上書きするかを設定します。*false*の場合、同名のファイルがあった際にはサフィックスに連番が付きます。                                  |
|                        | Output Directory Path              | 出力先のディレクトリを設定します。デフォルトでは"[Project]/Saved/GraphPrinter/"以下となっています。                                       |
| Generic Graph Printer  | Padding                            | 画像に出力する際の余白を設定します。ノードが見切れる際などに値を大きくしてください。                                                              |
|                        | Draw Only Graph                    | グラフエディタのタイトルバーと右下のグラフタイプのテキストを非表示にするかどうかを設定します。                                                         |
| Material Graph Printer | Material Graph Export Method       | マテリアルグラフを出力する方法。プレビュービューポートを出力画像に結合したり、別々に出力したりできます。                                                    |
| Editor Extension       | Hide Toolbar Combo Button          | アセットエディタのツールバーでプラグインの機能を実行するコンボボタンを非表示にする場合は*true*にします。                                                 |

## ライセンス

[MITライセンス](https://ja.wikipedia.org/wiki/MIT_License)

## 作者

[Naotsun](https://twitter.com/Naotsun_UE)

## 履歴

- (2022/05/27) v2.1   
  ツールバーやツールメニューから機能を実行できるようにしました
  マテリアルグラフを出力する時にプレビュービューポートも一緒に出力する機能を追加しました  
  プラグインのモジュールやクラスを大幅に改善しました

- (2021/12/25) v2.0   
  グラフエディタのタイトルバーなどを非表示にできるオプションを追加しました

- (2021/11/28) v1.9   
  Linux環境でのUE4.27のコンパイルエラーを修正しました

- (2021/10/20) v1.8   
  UE5に対応しました  

- (2021/07/11) v1.7   
  グラフエディタの画像をクリップボードにコピーするショートカットキーを追加した(**Windows限定**)  

- (2021/05/28) v1.6   
  リファレンスビューワーを出力した時にファイル名にアセット名が含まれるように変更した  

- (2021/05/05) v1.5   
  エンジンを起動して初めて出力する画像が白みがかる不具合の対処を行った  

- (2021/04/15) v1.4   
  ノード情報を画像ファイルに埋め込み、画像ファイルからノードを復元する機能を追加  

- (2021/03/08) v1.3   
  ~~エンジンを起動して初めて出力する画像が白みがかる不具合の対処を行った~~

- (2021/01/21) v1.2   
  パッケージ化の際にエラーが発生する対策としてモジュールタイプをEditorNoCommandletに変更

- (2021/01/12) v1.1  
  巨大なグラフを出力する際にクラッシュするため、出力サイズに制限をかけられる機能を追加

- (2020/12/06) v1.0   
  プラグインを公開
